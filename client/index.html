<!DOCTYPE html>
<html lang="en">
  <head>
    <link
      rel="preload"
      href="/optimized/hero_1-800w.webp"
      as="image"
      type="image/webp"
      fetchPriority="high"
    />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>
      AllCasa - Toronto Custom Home Construction & Full Home Renovation Services
    </title>

    <meta
      name="description"
      content="Toronto's premier custom home builders specializing in new luxury custom house design and build, full home renovation, and full basement renovation. Expert design-build services throughout the GTA. Get your free consultation today."
    />

    <meta
      name="robots"
      content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"
    />
    <meta name="googlebot" content="index, follow" />

    <meta property="og:type" content="website" />
    <meta
      property="og:title"
      content="AllCasa - Full Home Renovation & Luxury Custom House Design Build Toronto"
    />
    <meta
      property="og:description"
      content="Toronto's premier custom home builders specializing in new luxury custom house design and build, full home renovation, and full basement renovation throughout the GTA."
    />
    <meta property="og:site_name" content="AllCasa" />

    <meta
      name="keywords"
      content="full home renovation Toronto, full basement renovation, new luxury custom house design and build, custom home builders Toronto, design build Toronto, luxury home renovation, basement renovation GTA, custom house construction"
    />

    <!-- Route-aware lazy Google Fonts -->
    <script>
      (function () {
        var href =
          "https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap";
        var loaded = false;
        var path = location.pathname || "/";
        var isHeavyRoute = path === "/building-permit";
        var IDLE_TIMEOUT = isHeavyRoute ? 8000 : 2000;

        function loadFonts() {
          if (loaded) return;
          loaded = true;
          if (document.getElementById("google-fonts-styles")) return;
          var l = document.createElement("link");
          l.rel = "stylesheet";
          l.href = href;
          l.id = "google-fonts-styles";
          l.media = "all";
          document.head.appendChild(l);
        }

        window.loadFontsNow = loadFonts;

        function idleLoadWithTimeout() {
          if ("requestIdleCallback" in window) {
            requestIdleCallback(
              function () {
                loadFonts();
              },
              { timeout: IDLE_TIMEOUT }
            );
          } else {
            setTimeout(loadFonts, IDLE_TIMEOUT);
          }
        }

        if (!isHeavyRoute) {
          ["scroll", "pointerdown", "keydown", "touchstart"].forEach(function (
            evt
          ) {
            window.addEventListener(
              evt,
              function handler() {
                window.removeEventListener(evt, handler, { passive: true });
                loadFonts();
              },
              { passive: true, once: true }
            );
          });
        }

        window.addEventListener("load", idleLoadWithTimeout, { once: true });
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>

    <script type="module" src="/src/main.tsx"></script>

    <!-- Google Tag Manager - Route-aware lazy loader with Consent Mode defaults -->
    <script>
      (function () {
        var GTM_ID = "GTM-W4LSPXSW";
        var loaded = false;
        var isLocal = /^(localhost|127\.0\.0\.1|\[::1\])$/.test(
          location.hostname
        );
        var path = location.pathname || "/";
        var isHeavyRoute = path === "/building-permit";
        var IDLE_TIMEOUT = isHeavyRoute ? 12000 : 4000;

        if (isLocal) return;

        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({
          event: "default_consent",
          "gtm.consentDefault": {
            ad_storage: "denied",
            analytics_storage: "denied",
            functionality_storage: "granted",
            security_storage: "granted",
          },
        });

        function loadGTM() {
          if (loaded) return;
          loaded = true;
          window.dataLayer = window.dataLayer || [];
          window.dataLayer.push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js",
          });

          var s = document.createElement("script");
          s.async = true;
          s.src = "https://www.googletagmanager.com/gtm.js?id=" + GTM_ID;
          var f = document.getElementsByTagName("script")[0];
          f.parentNode.insertBefore(s, f);
        }

        window.loadGTMNow = loadGTM;

        function idleLoadWithTimeout() {
          if ("requestIdleCallback" in window) {
            requestIdleCallback(
              function () {
                loadGTM();
              },
              { timeout: IDLE_TIMEOUT }
            );
          } else {
            setTimeout(loadGTM, IDLE_TIMEOUT);
          }
        }

        if (!isHeavyRoute) {
          ["scroll", "pointerdown", "keydown", "touchstart"].forEach(function (
            evt
          ) {
            window.addEventListener(
              evt,
              function handler() {
                window.removeEventListener(evt, handler, { passive: true });
                loadGTM();
              },
              { passive: true, once: true }
            );
          });
        }

        window.addEventListener("load", idleLoadWithTimeout, { once: true });
      })();
    </script>
  </body>
</html>
